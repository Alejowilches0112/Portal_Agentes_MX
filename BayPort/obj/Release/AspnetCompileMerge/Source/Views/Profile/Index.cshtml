
@{

    ViewBag.Title = "Perfilar Cliente";
    Layout = "~/Views/Shared/_MenuLayout.cshtml";

}
@Html.Partial("~/views/shared/_NavBar.cshtml")
<ol class="breadcrumb">
    <li><a href="#">Producción</a></li>
    <li><a href="#">Perfilar Cliente</a></li>
</ol>


    <div ng-controller="PerfilarController" class="panel-group" id="accordion">
        <form name="formData" novalidate="novalidate" ng-submit="submit();">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne"><span class="glyphicon glyphicon-plus"></span> Información Personal</a>
                    </h4>
                </div>

                <div id="collapseOne" class="panel-collapse collapse">
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-xs-6 form-group">
                                <label for="lblDocument" class="control-label col-xs-6">Tipo Documento</label>
                                <div class="col-sm-13">

                                    <select class="selectpicker form-control" ng-init="formulario.tipoDoc='0';" name="tipoDoc" ng-model="formulario.tipoDoc">
                                        <option value="0">Selecione Tipo Documento</option>
                                        <option value="1">Cédula de Ciudadanía</option>
                                        <option value="2">Cédula de Extranjería</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-xs-6 form-group">
                                <label for="lblDocumentNumber" class="control-label col-xs-6">Número Documento</label>
                                <input type="text" class="form-control" id="inputDocumentNumber" name="numdoc" ng-model="formulario.numDoc" placeholder="Digite número de documento" format  ng-minlength="3" required>
                            </div>


                            <div class="col-xs-6 form-group">
                                <label for="lblFirstName" class="control-label col-xs-6">Primer Nombre</label>
                                <input type="text" class="form-control" id="inputFirstName" placeholder="Digite primer nombre" name="pNombre" ng-model="formulario.pNombre" required>
                            </div>
                            <div class="col-xs-6 form-group">
                                <label for="lblSecondName" class="control-label col-xs-6">Segundo Nombre</label>
                                <input type="text" class="form-control col-xs-6" id="inputSecondName" placeholder="Digite segundo nombre" name="sNombre" ng-model="formulario.sNombre">
                            </div>


                            <div class="col-xs-6 form-group">
                                <label for="lblFirstSurname" class="control-label col-xs-6">Primer Apellido</label>
                                <input type="text" class="form-control" id="inputFirstSurname" placeholder="Digite primer apellido" name="pApellido" ng-model="formulario.pApellido" required>
                            </div>
                            <div class="col-xs-6 form-group">
                                <label for="lblSecondSurname" class="control-label col-xs-6">Segundo Apellido</label>
                                <input type="text" class="form-control col-xs-6" id="inputSecondSurname" placeholder="Digite segundo apellido" name="sApellido" ng-model="formulario.sApellido">
                            </div>

                            <div class="col-xs-6 form-group">
                                <label for="lblCellphone" class="control-label col-xs-6">Celular</label>
                                <input type="text" class="form-control" id="inputCellphone" placeholder="Digite número de celular" name="Celular" ng-model="formulario.Celular" ng-maxlength="10" required>
                            </div>

                            <div class="col-xs-6 form-group">
                                <label for="lblBirthDay" class="control-label col-xs-6">Fecha de Nacimiento</label>
                                <div class="col-sm-12">

                                    <div class='input-group date'>
                                        <input type='text' id='datetimepicker1' class="form-control" name="fecNac" ng-model="formulario.fecNac" required />
                                        <span class="input-group-addon">
                                            <span class="glyphicon glyphicon-calendar"></span>
                                        </span>

                                    </div>
                                </div>
                            </div>

                            <div class="col-xs-6 form-group">
                                <label for="lblGenero" class="control-label col-xs-6">Genero</label>
                                <div class="col-sm-8" ng-init="formulario.gender='1'">
                                    <label class="radio-inline col-xs-4"> <input type="radio" name="gender" id="rbFemale" value="1" ng-checked="true" ng-model="formulario.gender"> Femenino </label>
                                    <label class="radio-inline col-xs-4"> <input type="radio" name="gender" id="rbMale" value="2" ng-model="formulario.gender"> Masculino </label>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo"><span class="glyphicon glyphicon-plus"></span> Información Laboral</a>
                    </h4>
                </div>
                <div id="collapseTwo" class="panel-collapse collapse">
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-xs-6 form-group">
                                <label for="lblConvenio" class="control-label col-xs-6">Convenio</label>
                                <div class="col-sm-13">
                                    <select class="selectpicker form-control" ng-model="ConvenioID" ng-options="convenio.agreementCode as convenio.agreementName for convenio in ConvenioList.agreementsList" ng-change="GetPagaduria();">
                                        <option value="">{{ConvenioTextToShow}}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-xs-6 form-group">
                                <label for="lblPagaduria" class="control-label col-xs-6">Pagaduría</label>
                                <div class="col-sm-13">
                                    <select class="selectpicker form-control" ng-model="PagaduriaID" ng-options="Pagaduria.payableCode as Pagaduria.payableName for Pagaduria in PagaduriaList.payableList" ng-change="GetTiposContrato()">
                                        <option value="">{{PagaduriaTextToShow}}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-xs-6 form-group">
                                <label for="lblTipoContrato" class="control-label col-xs-6">Tipo Contrato</label>
                                <div class="col-sm-13">
                                    <select class="selectpicker form-control" ng-model="TipoContratoID" ng-options="TipoContrato.contractCode as TipoContrato.contractName for TipoContrato in TipoContratoList.contractList" ng-change="GetRango()">
                                        <option value="">{{TipoContratoTextToShow}}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-xs-6 form-group">
                                <label for="lblRango" class="control-label col-xs-6">Rango</label>
                                <div class="col-sm-13">
                                    <select class="selectpicker form-control" ng-model="formulario.rango" ng-options="Rango.positionCode as Rango.positionName for Rango in RangoList.positionList">
                                        <option value="">{{RangoTextToShow}}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-xs-6 form-group">
                                <label for="lblActivoPensionado" class="control-label col-xs-6">Activo/Pensionado</label>
                                <div class="col-sm-13">
                                    <select class="selectpicker form-control" ng-init="formulario.estado='0';" name="estado" ng-model="formulario.estado">
                                        <option value="0">SELECCIONE ESTADO</option>
                                        <option value="1">ACTIVO</option>
                                        <option value="2">PENSIONADO</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-xs-6 form-group">
                                <label for="lblFechaIngreso" class="control-label col-xs-6">Fecha Ingreso</label>
                                <div class="col-sm-12">
                                    <div class='input-group date'>
                                        <input type='text' id='datetimepicker2' class="form-control" name="fecIng" ng-model="formulario.fecIng" required />
                                        <span class="input-group-addon">
                                            <span class="glyphicon glyphicon-calendar"></span>
                                        </span>

                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree"><span class="glyphicon glyphicon-plus"></span> Información Financiera</a>
                    </h4>
                </div>
                <div id="collapseThree" class="panel-collapse collapse">
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-xs-6 form-group">
                                <div class="panel panel-default ">
                                    <fieldset class="form-group" style="margin-bottom: 276px;">
                                        <legend>Ingresos</legend>

                                        <label for="lblSalario" class="control-label col-xs-10">Salario/Pensión</label>
                                        <input type="text" class="form-control col-xs-8" id="inputSalario" placeholder="Digite valor salario" name="salario" ng-model="formulario.salario" format >
                                        <label for="lblOtrosIngresos" class="control-label col-xs-10">Otros Ingresos</label>
                                        <input type="text" class="form-control col-xs-10" id="inputOtrosIngresos" placeholder="Digite otros ingresos" name="otroingreso" ng-model="formulario.otroingreso" format>

                                    </fieldset>
                                </div>
                            </div>
                            <div class="col-xs-6 form-group">
                                <div class="panel panel-default">
                                    <fieldset class="form-group">
                                        <legend>Descuentos</legend>
                                        <label for="lblSalud" class="control-label col-xs-10">Salud</label>
                                        <input type="text" class="form-control col-xs-8" id="inputSalud" placeholder="Digite valor salud" name="valorSalud" ng-model="formulario.valorSalud" format>
                                        <label for="lblPension" class="control-label col-xs-10">Pensión</label>
                                        <input type="text" class="form-control col-xs-10" id="inputPension" placeholder="Digite valor pensión" name="pension" ng-model="formulario.valorPension" format>
                                        <label for="lblRetefuente" class="control-label col-xs-10">Retefuente</label>
                                        <input type="text" class="form-control col-xs-8" id="inputRetefuente" placeholder="Digite valor retefuente" name="retefuente" ng-model="formulario.retefuente" format>
                                        <label for="lblFondoSolidaridad" class="control-label col-xs-10">Fondo Solidaridad</label>
                                        <input type="text" class="form-control col-xs-10" id="inputFondoSolidaridad" placeholder="Digite valor fondo solidaridad" name="solidaridad" ng-model="formulario.solidaridad" format>
                                        <label for="lblOtrosDctos" class="control-label col-xs-10">Otros Descuentos</label>
                                        <input type="text" class="form-control col-xs-10" id="inputOtrosDctos" placeholder="Digite otros descuentos" name="descuentos" ng-model="formulario.descuentos" format>

                                    </fieldset>
                                </div>
                            </div>

                        </div>


                    </div>
                </div>
            </div>
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseFour"><span class="glyphicon glyphicon-plus"></span> Información Solicitud</a>
                    </h4>
                </div>
                <div id="collapseFour" class="panel-collapse collapse">
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-xs-6 form-group">
                                <label for="lblTipoCredito" class="control-label col-xs-6">Tipo Crédito</label>

                                <div class="col-sm-13">
                                    <select class="selectpicker form-control" ng-model="formulario.tipoCredito" ng-options="tipcredito.productCode as tipcredito.productName for tipcredito in TipCreditoList.loanTypeList">
                                        <option value="">SELECCIONE TIPO CREDITO</option>
                                    </select>
                                </div>

                            </div>

                            <div class="col-xs-6 form-group">
                                <label for="lblLineaCredito" class="control-label col-xs-6">Línea de Crédito</label>
                                <div class="col-sm-13">
                                    <select class="selectpicker form-control" ng-model="formulario.lineCredito" ng-options="linecredito.loanLine as linecredito.lineDescription for linecredito in LineCreditoList.loanLineList">
                                        <option value="">SELECCIONE LINEA DE CREDITO</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-xs-6 form-group">
                                <label for="lblMonto" class="control-label col-xs-6">Monto</label>
                                <input type="text" class="form-control" id="inputFirstSurname" placeholder="Digite monto" name="monto" ng-model="formulario.monto" format>
                            </div>

                            <div class="col-xs-6 form-group">
                                <label for="lblCompraCartera" class="control-label col-xs-6">Valor Compra de Cartera</label>
                                <input type="text" class="form-control col-xs-6" id="inputSecondSurname" placeholder="Digite valor compra cartera" name="cartera" ng-model="formulario.valorCartera" format>
                            </div>

                            <div class="col-xs-5 form-group">
                                <h6 style="font-weight:bold; width:80%;">Detalle Compras (Compra de Cartera)</h6>
                            </div>

                            <div class="col-xs-2">

                                <button type="button" class="btn btn-primary btn-xs" data-toggle="modal" data-target="#myModal">Agregar</button>

                            </div>
                        </div>

                        <!-- Modal -->
                        <div class="modal fade" id="myModal" role="dialog">
                            <div class="modal-dialog modal-md">
                                <div class="modal-content">

                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                        <h5 class="modal-title">Agregar Cartera</h5>
                                    </div>
                                    <div class="modal-body">
                                        <div class="row">
                                            <div class="col-xs-4"><label>Entidad</label></div>
                                            <select class="selectpicker form-control col-xs-8" style="width:64%;" ng-model="formulario.Entname" ng-options="entidad.entityCode as entidad.entityName for entidad in EntityList.purchaseEntityList">
                                                <option value="">{{EntidadTextToShow}}</option>
                                            </select>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-4"><label>Cuota</label></div>
                                            <div class="col-xs-8"><input type="text" class="form-control" id="inputRule" ng-model="formulario.cuota" placeholder="Digite Cuota" format></div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-4"><label>Saldo</label></div>
                                            <div class="col-xs-8"><input type="text" inputmode="numeric" class="form-control" id="inputRule" ng-model="formulario.saldo" placeholder="Digite Saldo" format></div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-4"><label>En desprendible?</label></div>
                                            <div class="col-sm-8" ng-init="formulario.desprendible='1'">
                                                <label class="radio-inline col-xs-2"> <input type="radio" ng-model="formulario.desprendible" name="desprendible" id="rbDesprendibleSI" value="1" ng-checked="true">SI</label>
                                                <label class="radio-inline col-xs-2"> <input type="radio" ng-model="formulario.desprendible" name="desprendible" id="rbDesprendibleNO" value="0">NO</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-primary btn-xs" data-dismiss="modal" ng-click="GuardarEntity()">Guardar</button>
                                    </div>


                                </div>

                            </div>
                        </div>

                        <div class="col-xs-12 form-group">
                            <table class="table table-hover" ng-if="mostrartabla">
                                <thead>
                                    <tr>
                                        <th>Codigo</th>
                                        <th>Nombre</th>
                                        <th>Cuota</th>
                                        <th>Saldo</th>
                                        <th>En desprendible?</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="item in cartera">
                                        <td>{{item.name}}</td>
                                        <td>{{item.descripcion}}</td>
                                        <td>{{item.cuota }}</td>
                                        <td>{{item.saldo }}</td>
                                        <td>{{item.desprendible}}</td>
                                        <td><a href="#" class="glyphicon glyphicon-trash" data-ng-click="removeItem($index)">.</a></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>


                    </div>
                </div>

            </div>
            <br />
       

            <div class="panel-group text-right">
                <button type="submit" class="btn btn-primary btn-xs" ng-click="procesarFormulario(formData.$valid)">Procesar Solicitud</button>

            </div>
   
           
        </form>
</div>

    



