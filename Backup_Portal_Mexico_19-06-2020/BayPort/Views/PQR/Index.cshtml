
@{
    ViewBag.Title = "Consulta de PQR";
    Layout = "~/Views/Shared/_MenuLayout.cshtml";
}

@Html.Partial("~/views/shared/_NavBar.cshtml")

<ol class="breadcrumb">
    <li><a href="#">Aclaraciones</a></li>
    <li><a href="#">Consultar</a></li>
</ol>
<div ng-controller="PQRController"  ng-init="GetFlow();GetStates();GetExecutiveLevel();">
    <form name="PQRByExecutive" autocomplete="off">
        <fieldset class="form-group container-fluid">
            <legend>Consulta Aclaraciones por Agente</legend>
        </fieldset>

        <div class="panel panel-default col-xs-12">
            <div class="panel-body">
                <ul class="nav nav-pills">
                    <li role="presentation" class="active">
                        <a href="#nroPQR" role="tab" data-toggle="tab" style="font-weight: bold;">Nro. Aclaración</a>
                    </li>
                    <li role="presentation">
                        <a href="#nroCredito" role="tab" data-toggle="tab" style="font-weight: bold;">Nro. Crédito</a>
                    </li>
                    <li role="presentation">
                        <a href="#fechaDesembolso" role="tab" data-toggle="tab" style="font-weight: bold;">Fecha de Desembolso</a>
                    </li>
                    <li role="presentation">
                        <a href="#fechaPago" role="tab" data-toggle="tab" style="font-weight: bold;">Fecha de Pago</a>
                    </li>
                    <li role="presentation">
                        <a href="#flujo" role="tab" data-toggle="tab" style="font-weight: bold;">Flujo</a>
                    </li>
                    <li role="presentation">
                        <a href="#flujoEstado" role="tab" data-toggle="tab" style="font-weight: bold;">Flujo / Estado</a>
                    </li>
                    <li role="presentation">
                        <a href="#asesoresCargo" role="tab" data-toggle="tab" style="font-weight: bold;">Asesores a Cargo</a>
                    </li>
                </ul>
                <div class="container-fluid">
                    <div class="tab-content ">
                        <div id="nroPQR" role="tabpanel" class="tab-pane fade in active">
                            <div class="col-xs-12 col-sm-8  col-md-8  col-lg-8   ">
                                <label for="lblIniDate" class="control-label">Número de Aclaración</label>
                                <div class='input-group date'>
                                    <input type="text" id='idNroCredito' name="nameNroCredito" ng-model="PQR.nroPQR" />
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2 ">
                                <label for="lblIniDate" class="control-label"></label>
                                <button type="submit" class="btn btn-info boton-info" ng-click="ConsultarPQR(1);">Consultar</button>
                            </div>
                            <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2 ">
                                <label for="lblIniDate" class="control-label"></label>
                                <button type="submit" class="btn btn-info boton-info" ng-click="LimpiarPQR();">Limpiar</button>
                            </div>
                        </div>
                        <div id="nroCredito" role="tabpanel" class="tab-pane fade">
                            <div class="col-xs-12 col-sm-8  col-md-8  col-lg-8   ">
                                <label for="lblIniDate" class="control-label">Número de Crédito</label>
                                <div class='input-group date'>
                                    <input type="text" id='idNroCredito' name="nameNroCredito" ng-model="PQR.nroCredito" />
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2 ">
                                <label for="lblIniDate" class="control-label"></label>
                                <button type="submit" class="btn btn-info boton-info" ng-click="ConsultarPQR(2);">Consultar</button>
                            </div>
                            <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2 ">
                                <label for="lblIniDate" class="control-label"></label>
                                <button type="submit" class="btn btn-info boton-info" ng-click="LimpiarPQR();">Limpiar</button>
                            </div>
                        </div>
                        <div id="fechaDesembolso" role="tabpanel" class="tab-pane fade ">

                            <div class="form-group col-xs-12 col-sm-4  col-md-4  col-lg-4   ">
                                <label for="lblIniDate" class="control-label">Desde</label>
                                <div class='date'>
                                    <input type="text" id='datetimepickerIni' name="fecIni" ng-model="PQR.fecIni" datepicker placeholder="DD/MM/AAAA" />
                                </div>
                            </div>
                            <div class=" form-group col-xs-12 col-sm-4 col-md-4 col-lg-4 ">
                                <label for="lblIniDate" class="control-label">Hasta</label>
                                <div class='date'>
                                    <input type="text" id='datetimepickerFin' name="fecFin" ng-model="PQR.fecFin" datepicker placeholder="DD/MM/AAAA" />
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2 ">
                                <label for="lblIniDate" class="control-label"></label>
                                <button type="submit" class="btn btn-info boton-info" ng-click="ConsultarPQR(3);">Consultar</button>
                            </div>
                            <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2 ">
                                <label for="lblIniDate" class="control-label"></label>
                                <button type="submit" class="btn btn-info boton-info" ng-click="LimpiarPQR();">Limpiar</button>
                            </div>

                        </div>
                        <div id="fechaPago" role="tabpanel" class="tab-pane fade">
                            <div class="form-group col-xs-12 col-sm-4  col-md-4  col-lg-4   ">
                                <label for="lblIniDate" class="control-label">Desde</label>
                                <div class='input-group date'>
                                    <input type="text" id='datetimepickerIni' name="fecIni" ng-model="PQR.fecIni" datepicker placeholder="DD/MM/AAAA" />
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-sm-4 col-md-4 col-lg-4  ">
                                <label for="lblIniDate" class="control-label">Hasta</label>
                                <div class='input-group date'>
                                    <input type="text" id='datetimepickerFin' name="fecFin" ng-model="PQR.fecFin" datepicker placeholder="DD/MM/AAAA" />
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2 ">
                                <label for="lblIniDate" class="control-label"></label>
                                <button type="submit" class="btn btn-info boton-info" ng-click="ConsultarPQR(4);">Consultar</button>
                            </div>
                            <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2 ">
                                <label for="lblIniDate" class="control-label"></label>
                                <button type="submit" class="btn btn-info boton-info" ng-click="LimpiarPQR();">Limpiar</button>
                            </div>
                        </div>

                        <div id="flujo" role="tabpanel" class="tab-pane fade">
                            <div class="col-xs-12 col-sm-4  col-md-4  col-lg-4 ">
                                <label for="lblIniDate" class="control-label">Tipo de Flujo</label>
                                <select class="selectpicker form-control" ng-model="PQR.TipoFlujo"
                                        ng-options="flujo.flowType as flujo.flowName for flujo in Flows.lstFlowType"
                                        style="height: 40px;padding-top: 0px; padding-bottom: 0px;">
                                    <option value="">Seleccione Tipo Flujo</option>
                                </select>
                            </div>
                            <div class="col-xs-12 col-sm-4  col-md-4  col-lg-4 ">
                            </div>
                            <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2 ">
                                <label for="lblIniDate" class="control-label"></label>
                                <button type="submit" class="btn btn-info boton-info" ng-click="ConsultarPQR(5);">Consultar</button>
                            </div>
                            <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2 ">
                                <label for="lblIniDate" class="control-label"></label>
                                <button type="submit" class="btn btn-info boton-info" ng-click="LimpiarPQR();">Limpiar</button>
                            </div>
                        </div>

                        <div id="flujoEstado" role="tabpanel" class="tab-pane fade">
                            <div class="col-xs-12 col-sm-4  col-md-4  col-lg-4   ">
                                <label for="lblIniDate" class="control-label">Tipo de Flujo</label>
                                <select class="selectpicker form-control" ng-model="PQR.TipoFlujo"
                                        ng-options="flujo.flowType as flujo.flowName for flujo in Flows.lstFlowType"
                                        style="height: 40px;padding-top: 0px; padding-bottom: 0px;">
                                    <option value="">Seleccione Tipo Flujo</option>
                                </select>

                            </div>
                            <div class="col-xs-12 col-sm-4  col-md-4  col-lg-4   ">
                                <label for="lblIniDate" class="control-label">Estado</label>
                                <select class="selectpicker form-control    " ng-model="PQR.Estado"
                                        ng-options="state.codeState as state.stateName for state in States.lstStates"
                                        style="height: 40px;padding-top: 0px; padding-bottom: 0px;">
                                    <option value="">Seleccione Estado</option>
                                </select>

                            </div>
                            <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2 ">
                                <label for="lblIniDate" class="control-label"></label>
                                <button type="submit" class="btn btn-info boton-info" ng-click="ConsultarPQR(6);">Consultar</button>
                            </div>
                            <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2 ">
                                <label for="lblIniDate" class="control-label"></label>
                                <button type="submit" class="btn btn-info boton-info" ng-click="LimpiarPQR();">Limpiar</button>
                            </div>
                        </div>

                        <div id="asesoresCargo" role="tabpanel" class="tab-pane fade">
                            <div class="col-xs-12 col-sm-4  col-md-4  col-lg-4   ">
                                <label for="lblIniDate" class="control-label">Nivel </label>
                                <select class="selectpicker form-control" ng-model="PQR.codigoNivel"
                                        ng-options="niveles.Code as niveles.Name for niveles in Levels.lstExecutiveLevel"
                                        style="height: 40px;padding-top: 0px; padding-bottom: 0px;"
                                        ng-change="GetExecutiveChilds();">
                                    <option value="">Seleccione Nivel</option>
                                </select>
                            </div>

                            <div class="col-xs-12 col-sm-4  col-md-4  col-lg-4   ">
                                <label for="lblIniDate" class="control-label">Asesor</label>
                                <select class="selectpicker form-control" ng-model="PQR.codigoHijo"
                                        ng-options="hijos.DocumentID as hijos.Name for hijos in Childs"
                                        style="height: 40px;padding-top: 0px; padding-bottom: 0px;">
                                    <option value="">Seleccione Asesor</option>
                                </select>
                            </div>

                            @*<div class="col-xs-12 col-sm-4  col-md-4  col-lg-4   ">
                                <label for="lblIniDate" class="control-label"> Asesor </label>
                                <div ng-dropdown-multiselect="" options="Childs" selected-model="lstExecutiveChildsSelected" checkboxes="true"
                                     extra-settings="settingsDropDownList" ng-show="mostrarLista" translation-texts="settingsDropDownTexts"
                                     style="height: 40px;padding-top: 0px; padding-bottom: 0px;border-radius:10px"></div>
                            </div>*@


                            <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2 ">
                                <label for="lblIniDate" class="control-label"></label>
                                <button type="submit" class="btn btn-info boton-info" ng-click="ConsultarPQR(7);">Consultar</button>
                            </div>
                            <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2 ">
                                <label for="lblIniDate" class="control-label"></label>
                                <button type="submit" class="btn btn-info boton-info" ng-click="LimpiarPQR();">Limpiar</button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <br />

        <div class="panel-heading">
            <h4 class="panel-title">
                <a> Resumen Aclaraciones </a>
            </h4>
        </div>
        <div class="table-responsive" style="border: 1px solid;">
            <table class="table table-hover">
                <thead>
                    <tr style="font-size: small;">
                        <th>Mes</th>
                        <th>Nombre Proceso</th>
                        <th>Estado</th>
                        <th>Número de Aclaraciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="item in SummaryPQR.lstSummaryPQR" style="font-size:  small; white-space:nowrap;">
                        <td>{{item.month}}</td>
                        <td>{{item.processName}}</td>
                        <td>{{item.status}} - {{item.stateName}}</td>
                        <td>{{item.PQRNumber}}</td>
                    </tr>
                </tbody>
            </table>

        </div>


        <div class="panel-heading">
            <h4 class="panel-title">
                <a> Detalle Aclaraciones </a>
            </h4>
        </div>

        <div class="panel panel-default">
            <div class="table-responsive" @*ng-show="visible"*@ style="border: 1px solid;">
                <table class="table table-hover">
                    <thead>
                        <tr style="font-size: small;">
                            <th></th>
                            <th># Crédito</th>
                            <th>Concepto</th>
                            <th>Nombre del Concepto</th>
                            <th>Fecha Solicitud</th>
                            <th>Nombre Promotor</th>
                            <th>Flujo</th>
                            <th>Motivo </th>
                            <th>Prioridad</th>
                            <th>Asignado a</th>
                            <th>Fecha de Cierre</th>
                            <th>Estatus Final</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="item in EncabezadoPQR.lstHeaderPQR" style="font-size:  small; white-space:nowrap;">
                            <td><a data-ng-click="ConsultarDetallePQR($index)" style="text-decoration: underline;color: #3f09e5;cursor:pointer;">Ver</a></td>
                            <td>{{item.loanNumber}}</td>
                            <td>{{item.flowType}} </td>
                            <td>{{item.flowName}}</td>
                            <td>{{item.dateInsertSYS}}</td>
                            <td>{{item.executiveName}} </td>
                            <td>{{item.customerName}}</td>
                            <td>{{item.reason}}</td>
                            <td>{{item.priorityName}}</td>
                            <td>{{item.AssignedAnalyst}}</td>
                            <td>{{item.closeDate}}</td>
                            <td>{{item.stateName}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>


        <div class="panel-group" id="accordion">


            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne"><span class="glyphicon glyphicon-plus"></span> Novedades </a>
                    </h4>
                </div>
                <div id="collapseOne" class="panel-collapse collapse">
                    <div class="table-responsive" ng-show="visible" style="border: 1px solid;">
                        <table class="table table-hover">
                            <thead>
                                <tr style="font-size: small;">
                                    <th># Crédito</th>
                                    <th>Flujo</th>
                                    <th>Novedad</th>
                                    <th>Nombre Promotor</th>
                                    <th>Descripción Novedad</th>
                                    <th>Fecha Novedad</th>
                                    <th>Colocó Novedad</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="item in NovedadesPQR.lstNoveltyPQR" style="font-size:  small; white-space:nowrap;">
                                    <td>{{item.loanNumber}}</td>
                                    <td>{{item.flow}}</td>
                                    <td>{{item.noveltyCode}} </td>
                                    <td>{{item.executiveName}}</td>
                                    <td>{{item.description}}</td>
                                    <td>{{item.dateInsertBusiness}}</td>
                                    <td>{{item.userInsert}}</td>
                                </tr>
                            </tbody>
                        </table>

                    </div>
                </div>
            </div>
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo"><span class="glyphicon glyphicon-plus"></span> LOG </a>
                    </h4>
                </div>
                <div id="collapseTwo" class="panel-collapse collapse">
                    <div class="table-responsive" ng-show="visible" style="border: 1px solid;">
                        <table class="table table-hover">
                            <thead>
                                <tr style="font-size: small;">
                                    <th>Número Proceso</th>
                                    <th>Secuencia Novedad</th>
                                    <th>Estado Anterior</th>
                                    <th>Estado Nuevo</th>
                                    <th>Descripción</th>
                                    <th>Fecha Inserta Negocio</th>
                                    <th>Usuario Inserta</th>
                                    <th>Fecha Inserta Sistema</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="item in LogPQR.lstLogPQR" style="font-size:  small; white-space:nowrap;">
                                    <td>{{item.processNumber}}</td>
                                    <td>{{item.SequenceNovelty}}</td>
                                    <td>{{item.previousState}} - {{item.statusNamePrevious}}</td>
                                    <td>{{item.newState}} - {{item.statusNameNew}}</td>
                                    <td>{{item.description}}</td>
                                    <td>{{item.dateInsertBusiness}}</td>
                                    <td>{{item.userInsert}}</td>
                                    <td>{{item.dateInsertSYS}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>
